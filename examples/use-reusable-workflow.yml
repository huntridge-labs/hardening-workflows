# Example: How to use the reusable security hardening workflow in another project

# yamllint disable rule:brackets
name: Security Pipeline

on:  # yamllint disable-line rule:truthy
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 2 * * 1'  # Run weekly on Mondays at 2 AM UTC
  workflow_dispatch:
    inputs:
      scanners:
        description: 'Comma-separated scanner tokens'
        required: true
        default: 'all'
        type: choice
        options:
          - all
          - sast
          - container
          - infrastructure
          - codeql
          - secrets

jobs:
  security-hardening:
    name: Security Hardening
    uses: huntridge-labs/hardening-workflows/.github/workflows/reusable-security-hardening.yml@2.0.0
    with:
      scanners: ${{ github.event.inputs.scanners || 'all' }}
      python_version: '3.11'
      aws_region: 'us-west-2'
      post_pr_comment: true
      codeql_languages: 'python'  # Only analyze Python, skip JavaScript
    secrets:
      AWS_ACCOUNT_ID: ${{ secrets.AWS_ACCOUNT_ID }}
    permissions:
      contents: read
      security-events: write
      actions: read
      pull-requests: write
      checks: write
      id-token: write
